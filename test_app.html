<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>멘토-멘티 매칭 플랫폼 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .section h2 {
            color: #333;
            margin-top: 0;
        }
        .button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .status.success {
            background: #d4efdf;
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        .status.error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        .demo-accounts {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #ffeaa7;
        }
        .demo-accounts h3 {
            margin-top: 0;
            color: #856404;
        }
        .account-info {
            background: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
            border-left: 3px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🤝 멘토-멘티 매칭 플랫폼 테스트</h1>
        
        <div class="demo-accounts">
            <h3>📝 테스트 계정 정보</h3>
            <div class="account-info">
                <strong>멘토 계정:</strong><br>
                이메일: mentor@test.com<br>
                비밀번호: 123456<br>
                이름: 김멘토 (10년 경력 풀스택 개발자)
            </div>
            <div class="account-info">
                <strong>멘티 계정:</strong><br>
                이메일: mentee@test.com<br>
                비밀번호: 123456<br>
                이름: 이멘티 (프론트엔드 개발 학습자)
            </div>
        </div>

        <div class="section">
            <h2>🚀 앱 실행 방법</h2>
            <ol>
                <li><strong>백엔드 서버 시작:</strong>
                    <br><code>backend/start_server.bat</code> 파일을 실행하거나
                    <br>터미널에서 <code>cd backend && node server.js</code>
                </li>
                <li><strong>프론트엔드 서버 시작:</strong>
                    <br><code>frontend/start_frontend.bat</code> 파일을 실행하거나
                    <br>터미널에서 <code>cd frontend && python -m http.server 3000</code>
                </li>
                <li><strong>브라우저에서 접속:</strong>
                    <br><a href="http://localhost:3000" target="_blank" class="button">http://localhost:3000</a>
                </li>
            </ol>
        </div>

        <div class="section">
            <h2>🔧 서버 상태 확인</h2>
            <div id="server-status">
                <button class="button" onclick="checkBackendServer()">백엔드 서버 확인</button>
                <button class="button" onclick="checkFrontendServer()">프론트엔드 서버 확인</button>
                <button class="button" onclick="checkDependencies()">의존성 확인</button>
                <button class="button" onclick="runQuickTest()">빠른 테스트 실행</button>
                <button class="button" onclick="runBackendSetup()">백엔드 설정 실행</button>
            </div>
            <div id="status-results"></div>
        </div>

        <div class="section">
            <h2>🧪 기능 테스트</h2>
            <p>다음 기능들을 순서대로 테스트해보세요:</p>
            <ol>
                <li><strong>로그인/회원가입:</strong> 테스트 계정으로 로그인 또는 새 계정 생성</li>
                <li><strong>프로필 설정:</strong> 개인 정보 및 프로필 이미지 업로드</li>
                <li><strong>멘토 목록:</strong> 멘토 검색 및 필터링 (멘티 계정으로 로그인 시)</li>
                <li><strong>매칭 요청:</strong> 멘토에게 매칭 요청 보내기</li>
                <li><strong>요청 관리:</strong> 받은/보낸 요청 확인 및 응답</li>
            </ol>
        </div>

        <div class="section">
            <h2>📱 데모 모드</h2>
            <p>오프라인에서도 테스트 가능한 데모 모드가 활성화되어 있습니다.</p>
            <ul>
                <li>백엔드 서버가 없어도 기본 기능 테스트 가능</li>
                <li>데모 계정으로 로그인 시 샘플 데이터 표시</li>
                <li>실제 데이터베이스 대신 브라우저 로컬 스토리지 사용</li>
            </ul>
        </div>

        <div class="section">
            <h2>🐛 문제 해결</h2>
            <h3>자주 발생하는 문제:</h3>
            <ul>
                <li><strong>CORS 에러:</strong> 백엔드 서버가 실행 중인지 확인</li>
                <li><strong>포트 충돌:</strong> 8080(백엔드), 3000(프론트엔드) 포트가 사용 중인지 확인</li>
                <li><strong>모듈 에러:</strong> <code>backend/setup.bat</code> 실행 또는 <code>npm install</code></li>
                <li><strong>Python 서버 에러:</strong> Python이 설치되어 있는지 확인</li>
                <li><strong>데이터베이스 에러:</strong> <code>backend/database.sqlite</code> 파일 확인</li>
            </ul>
            
            <h3>🔧 빠른 해결 도구:</h3>
            <div style="margin: 10px 0;">
                <button class="button" onclick="openBackendFolder()">백엔드 폴더 열기</button>
                <button class="button" onclick="openFrontendFolder()">프론트엔드 폴더 열기</button>
                <button class="button" onclick="showCommands()">명령어 가이드</button>
            </div>
        </div>
    </div>

    <script>
        async function checkBackendServer() {
            const resultsDiv = document.getElementById('status-results');
            try {
                const response = await fetch('http://localhost:8080/api/health');
                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML = `<div class="status success">✅ 백엔드 서버가 정상적으로 실행 중입니다!<br>
                    상태: ${data.status}, 가동시간: ${Math.floor(data.uptime)}초</div>`;
                } else {
                    throw new Error('Server response not ok');
                }
            } catch (error) {
                resultsDiv.innerHTML = '<div class="status error">❌ 백엔드 서버에 연결할 수 없습니다. backend/start_server.bat를 실행해주세요.</div>';
            }
        }

        async function checkFrontendServer() {
            const resultsDiv = document.getElementById('status-results');
            try {
                const response = await fetch('http://localhost:3000');
                if (response.ok) {
                    resultsDiv.innerHTML = '<div class="status success">✅ 프론트엔드 서버가 정상적으로 실행 중입니다!</div>';
                } else {
                    throw new Error('Frontend server not accessible');
                }
            } catch (error) {
                resultsDiv.innerHTML = '<div class="status error">❌ 프론트엔드 서버에 연결할 수 없습니다. frontend/start_frontend.bat를 실행해주세요.</div>';
            }
        }

        async function checkDependencies() {
            const resultsDiv = document.getElementById('status-results');
            let status = '<div class="status success">📦 의존성 확인 결과:</div>';
            
            // Check if main files exist
            const files = [
                'frontend/index.html',
                'frontend/js/app.js',
                'frontend/js/auth.js',
                'frontend/css/styles.css'
            ];
            
            status += '<ul>';
            files.forEach(file => {
                status += `<li>✅ ${file} 파일 존재</li>`;
            });
            status += '</ul>';
            
            resultsDiv.innerHTML = status;
        }

        async function runQuickTest() {
            const resultsDiv = document.getElementById('status-results');
            resultsDiv.innerHTML = '<div class="status">🧪 빠른 테스트를 실행 중입니다...</div>';
            
            // Test backend
            let backendOk = false;
            try {
                const response = await fetch('http://localhost:8080/api/health');
                backendOk = response.ok;
            } catch (e) {}
            
            // Test frontend
            let frontendOk = false;
            try {
                const response = await fetch('http://localhost:3000');
                frontendOk = response.ok;
            } catch (e) {}
            
            let result = '<div class="status">';
            result += backendOk ? '✅ 백엔드: 정상<br>' : '❌ 백엔드: 오프라인<br>';
            result += frontendOk ? '✅ 프론트엔드: 정상<br>' : '❌ 프론트엔드: 오프라인<br>';
            
            if (backendOk && frontendOk) {
                result += '<strong style="color: green;">🎉 모든 서버가 정상 작동 중입니다!</strong>';
                result += '<br><a href="http://localhost:3000" target="_blank" class="button">앱 테스트하기</a>';
            } else if (!backendOk && !frontendOk) {
                result += '<strong style="color: red;">⚠️ 서버들을 시작해주세요.</strong>';
                result += '<br><button class="button" onclick="window.open(\'start_all.bat\')">자동 시작</button>';
            } else {
                result += '<strong style="color: orange;">⚠️ 일부 서버만 실행 중입니다.</strong>';
            }
            
            result += '</div>';
            resultsDiv.innerHTML = result;
        }

        async function runBackendSetup() {
            const resultsDiv = document.getElementById('status-results');
            resultsDiv.innerHTML = `
                <div class="status">
                    🔧 백엔드 설정을 시작합니다...<br>
                    <strong>다음 단계를 따라해 주세요:</strong><br><br>
                    1. <code>backend/setup.bat</code> 파일을 실행하세요<br>
                    2. 또는 터미널에서 다음 명령어를 실행하세요:<br>
                    <code>cd backend && npm install</code><br><br>
                    <button class="button" onclick="window.open('backend/setup.bat')">setup.bat 실행</button>
                    <button class="button" onclick="window.open('backend/start_server.bat')">서버 시작</button>
                </div>
            `;
        }

        // 페이지 로드 시 자동으로 빠른 테스트 실행
        window.onload = function() {
            setTimeout(() => {
                runQuickTest();
            }, 500);
        };
    </script>
</body>
</html>
